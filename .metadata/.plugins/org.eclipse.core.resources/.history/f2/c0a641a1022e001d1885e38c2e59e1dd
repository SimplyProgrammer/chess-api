package org.ugp.api.chess.enginev2;

public class Piece {
	public static final int BLACK = 0;
	public static final int WHITE = 1;
	private int x;
	private int y;
	private int color;
	protected boolean hasMoved;
	protected Board chessBoard;
	protected String type;
	
	public Piece(Board board, int color){
		this.chessBoard = board;
		this.color = color;
		hasMoved = false;
		x = -1;
		y = -1;
	}
	
	public Piece(Board board, String type, int color, int xLoc, int yLoc){
		this.chessBoard = board;
		this.color = color;
		this.hasMoved = false;
		this.x = xLoc;
		this.y = yLoc;
		this.type = type;
		
		chessBoard.placePiece(this, xLoc, yLoc);
	}
	
	public boolean canMoveTo(int xPosition, int yPosition){
		return canMoveGenerics(xPosition, yPosition);
	}
	
	protected boolean canMoveGenerics(int xPosition, int yPosition){
		if (chessBoard.isInBounds(xPosition, yPosition)){
			ChessPiece location = chessBoard.pieceAt(xPosition, yPosition);
			
			if (location == null) return true;
			if (location.getColor() != this.color) return true; 
		}
		return false;
	}
	
	public void moveTo(int xPosition, int yPosition){	
			if (chessBoard.pieceAt(x, y) == this)
				chessBoard.removeFromBoard(this);
			this.x = xPosition;
			this.y = yPosition;
			
			ChessPiece target = chessBoard.pieceAt(xPosition, yPosition);
			if (target != null){
				this.capturePiece(target);
			}
			
			chessBoard.placePiece(this, xPosition, yPosition);
			hasMoved = true;
	}
	
	public void removePiece() {
		chessBoard.removeFromBoard(this);
		x = -1;
		y = -1;
	}
	
	public void capturePiece(ChessPiece capturedPiece){
		capturedPiece.removePiece();
	}
	
	public boolean onBoard(){
		if (chessBoard.isInBounds(x, y))
			return true;
		return false;
	}
	
	public int getX(){
		return x;
	}
	
	public int getY(){
		return y;
	}
	
	public int getColor(){
		return color;
	}
	
	public Board getBoard(){
		return chessBoard;
	}

	protected boolean isMovingStraight(int xPosition, int yPosition) {
		int currX = this.getX();
		int currY = this.getY();
		
		int smallerVal;
		int largerVal;
		
		
		if (currX == xPosition){
			if (currY > yPosition){
				smallerVal = yPosition;
				largerVal = currY;
			}
			else if (yPosition > currY){
				smallerVal = currY;
				largerVal = yPosition;
			}
			else 
				return false;
			
			smallerVal++;
			for(; smallerVal < largerVal; smallerVal++){
				if (chessBoard.pieceAt(currX, smallerVal) != null){
					return false;
				}
			}
			return true;
		}
		
		
		if (currY == yPosition){
			if (currX > xPosition){
				smallerVal = xPosition;
				largerVal = currX;
			}
			else if (xPosition > currX){
				smallerVal = currX;
				largerVal = xPosition;
			}
			else 
				return false;
			
			smallerVal++;
			for(; smallerVal < largerVal; smallerVal++){
				if (chessBoard.pieceAt(smallerVal, currY) != null){
					return false;
				}
			}
			return true;
		}
		
		return false;
	}

	
	protected boolean isMovingDiagonal(int xPosition, int yPosition) {
		int xStart = 0;
		int yStart = 0;
		int xFinish = 1;
		
		int xTotal = Math.abs(xPosition - this.getX());
		int yTotal = Math.abs(yPosition - this.getY());
		
		if (xTotal == yTotal){
			if (xPosition < this.getX()){
				xStart = xPosition;
				xFinish = this.getX();
			}
			else if (xPosition > this.getX()){
				xStart = this.getX();
				xFinish = xPosition;
			}
			else
				return false;
			
			if (yPosition < this.getY()){
				yStart = yPosition;
				
			}
			else if (yPosition > this.getY()){
				yStart = this.getY();
				
			}
			else
				return false;
			
			xStart++;
			yStart++;
			
			
			for(;xStart < xFinish; xStart++, yStart++){
				if (chessBoard.pieceAt(xStart, yStart) != null){
					return false;
				}
			}
			
			return true;
		}
		
		return false;
	}
}
